<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CAPDDDEs: RIGOROUS INTEGRATOR FOR DELAY DIFFERENTIAL EQUATIONS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CAPDDDEs
   &#160;<span id="projectnumber">0.2.1</span>
   </div>
   <div id="projectbrief">ComputerAssistedProofsinDynamicsofDelayDifferentialEquations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">RIGOROUS INTEGRATOR FOR DELAY DIFFERENTIAL EQUATIONS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>A library to do rigorous numerics for Delay Differential Equations based on [^phd-thesis], [^rignum-ddes], [^high-order-ddes].</p>
<h1><a class="anchor" id="autotoc_md5"></a>
TL;DR</h1>
<p>If you have <code>Debian</code> based system (tested: Ubuntu 20.04), then to see the project in action, you can run:</p>
<div class="fragment"><div class="line">sudo apt-get install libgmp-dev libmpfr-dev libboost-all-dev git cmake autoconf libtool</div>
<div class="line">git clone git@github.com:robsontpm/capdDDEs.git capdDDEs</div>
<div class="line">cd capdDDEs</div>
<div class="line">cp build-conf-bundle.mk build-conf.mk </div>
<div class="line">chmod a+x tldr.sh</div>
<div class="line">./tldr.sh</div>
</div><!-- fragment --><p>It might take some time to compile everything. The next sections describes what is done in <code>tldr.sh</code> script.</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Requirements</h1>
<p>The requirements are the same as for <a href="http://capd.ii.uj.edu.pl">CAPD library</a>, which are:</p>
<ul>
<li>gcc, g++ or clang++ (must support at least C++17 standard).</li>
<li>make, cmake (version 3.13.0 or newer)</li>
<li>pkg-config</li>
<li>git</li>
<li>gmp, mpfr (for multiprecision, some tools in capdDDEs uses those)</li>
<li>Boost library (header files and binaries)</li>
</ul>
<p>In Debian based systems you can run:</p>
<div class="fragment"><div class="line">sudo apt-get install libgmp-dev libmpfr-dev libboost-all-dev git cmake autoconf libtool</div>
</div><!-- fragment --><p>The documentation and the compilation system uses for now the <code>g++</code> compiler. You can change it in your <code>build-conf.mk</code> file in the root directory (see docs below).</p>
<h1><a class="anchor" id="autotoc_md7"></a>
Compilation</h1>
<p>Assuming you have all the needed requirements, to start using this project you can do the following steps (we assume you have -nix type of system, Windows is unsupported):</p>
<p>First clone the repo:</p>
<div class="fragment"><div class="line">git clone git@github.com:robsontpm/capdDDEs.git capdDDEs</div>
<div class="line">cd capdDDEs</div>
</div><!-- fragment --><p>You should choose one of the possible configs of the building system: </p><div class="fragment"><div class="line">ls | grep &quot;build-conf-&quot;</div>
</div><!-- fragment --><p>You need to copy one of them into file named <code>build-conf.mk</code>. This file is not tracked by the <code>git</code> version control. Currently, the difference between various versions lies in where the library will look for <code>CAPD</code> library.</p>
<p>Currently, you have two options: decide to go with the <code>CAPD</code> that is a submodule of this project and is maintained by github git repository (the default behaviour) or to setup your own distribution of <code>CAPD</code> if you already have one. In this example we go with the submoduled version (maintained from github and updated automatically):</p>
<div class="fragment"><div class="line">cp build-conf-bundle.mk build-conf.mk</div>
</div><!-- fragment --><p>Next, go to external, add permissions and build CAPD library (it is a long process):</p>
<div class="fragment"><div class="line">cd external</div>
<div class="line">chmod a+x capd/configure</div>
<div class="line">chmod a+x capd-build.sh</div>
<div class="line">./capd-build.sh</div>
</div><!-- fragment --><p>Then, after capd is build without errors, go back to root directory and compile some exemplary programs using make:</p>
<div class="fragment"><div class="line">cd ..</div>
<div class="line">make examples/mackey-glass-stable-periodic</div>
</div><!-- fragment --><p>Compiled programs will go to **./bin** directory inside this particular example directory:</p>
<div class="fragment"><div class="line">ls programs/examples/mackey-glass-stable-periodic/bin</div>
<div class="line"> </div>
<div class="line"># sample output of the above ls commands are:</div>
<div class="line">#</div>
<div class="line">#    find-and-prove-n6</div>
<div class="line">#</div>
</div><!-- fragment --><p>Finally, run proofs or demos, e.g. :</p>
<div class="fragment"><div class="line">cd programs/examples/mackey-glass-stable-periodic/bin</div>
<div class="line">./find-and-prove-n6</div>
</div><!-- fragment --><p>You can see list of available programs and demos by running in the main directory of the repository the following command:</p>
<div class="fragment"><div class="line">cd ../../../..</div>
<div class="line">make list</div>
</div><!-- fragment --><p>If you are interested in more documentation, see ./docs</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Using your own CAPD</h1>
<p>The <code>-bundle</code> version forces you to compile the version of <code>CAPD</code> library, that is in <code>external</code> folder. In case you already have <code>CAPD</code> up and running, you might want to use other templates and configure them to your needs. Just copy the <code>-svn</code> version, e.g.:</p>
<div class="fragment"><div class="line">cp build-conf-svn.mk build-conf.mk</div>
</div><!-- fragment --><p>and either specify the paths in this <code>build-conf.mk</code> file (uncomment some lines there) or follow the instructions in the file to export global system variables.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
Contact</h1>
<p>In case of any problems, please contact me at <a href="#" onclick="location.href='mai'+'lto:'+'rob'+'er'+'t.s'+'zc'+'zel'+'in'+'a@u'+'j.'+'edu'+'.p'+'l'; return false;">rober<span style="display: none;">.nosp@m.</span>t.sz<span style="display: none;">.nosp@m.</span>czeli<span style="display: none;">.nosp@m.</span>na@u<span style="display: none;">.nosp@m.</span>j.edu<span style="display: none;">.nosp@m.</span>.pl</a> - I will provide as much support as possible, especially I will contact people from CAPD project if there would be any problems with building it. Please attach as much information as possible (e.g. output of build.sh / configure / make programs),version of your OS, maybe some screenshots.</p>
<p>Aditional programs (proofs) are usually attached to the recent manuscripts, see the References section below.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
DESCRIPTION OF THIS PROJECT</h1>
<p>The repository contains source codes for the rigorous integration library for Delay Differential Equations (DDEs) of the form[^1]:</p>
<div class="fragment"><div class="line">x&#39;(t) = f(x(t), x(t-d1), ..., x(t-dm))</div>
</div><!-- fragment --><p>Where d1,..., dm are m delays. It is build upon ideas from CAPD library for ODEs (capd.ii.uj.edu.pl). By rigorous methods we understand routines that compute the enclosure (interval bounds) on the <b>true</b> solutions to the problems. Those in turn might be applied in Computer Assisted Proofs, that is, in mathematical proofs, that verify some assumptions by appropriate computer programs. Please reffer to <a href="capd.ii.uj.edu.pl">CAPD</a> documentation for general papers on the topic. See <b>References</b> for the papers specyfic to DDEs [^1][^2][^3][^4].</p>
<p>This project requires the <a href="capd.ii.uj.edu.pl">CAPD library</a>, but the repository contains compatible CAPD version in './external/' directory as a <code>git</code> submodule downloaded autmatically from <code>github.com</code>. You can use your own version of the CAPD, but in that case you need to modify <code>CAPDBINDIR</code> and <code>CAPDLIBDIR</code> variables in the template Makefile scripts </p><div class="fragment"><div class="line"> {build-conf.mk```.}</div>
<div class="line"> </div>
<div class="line">The work is open-source, under GPLv3 license. Please consider</div>
<div class="line">citing some of the papers listed in **References**, when using this </div>
<div class="line">work in any scientific project.</div>
<div class="line"> </div>
<div class="line">PROJECT STRUCTURE (UPDATED 2023)</div>
<div class="line">--------------------------------</div>
<div class="line"> </div>
<div class="line">A short description of available folders / files. A detailed README.md</div>
<div class="line">file can be found in some of them, when necessary. The project is in </div>
<div class="line">constant evolution, so changes can be made. When the core part of </div>
<div class="line">library would become part of CAPD, then the structure would be more</div>
<div class="line">or less constant.</div>
<div class="line"> </div>
<div class="line"> - ```include</div>
</div><!-- fragment --> <pre class="fragment">As the library is mostly based on C++ templates, most
of the code is here. 
</pre><ul>
<li><code>include/ddes</code> the core of the rigorous integrator for DDEs</li>
<li><code>include/ddeshelper</code> some extra routines to help with programs. Might not be the part of the CAPD library, when ddes are included.</li>
<li><code>src/</code> As not all functions are templated, their implementation need to go to .cpp files in here.</li>
<li><p class="startli"><code>programs/</code> this is a directory to put any programs to be compiled with the build-in compilation system. See <b>CUSTOM PROGRAMS</b> later to learn how you can use this structure.</p>
<p class="startli"><em>TODO: describe in more detail.</em></p>
</li>
<li><p class="startli"><code>Makefile</code> this file may be used to build programs inside the library.</p>
<p class="startli">Just call:</p>
<p class="startli">```bash make <em>program-name</em> ```</p>
<p class="startli">where <code>_program-name_</code> is equal to the name of any directory under <code>programs/</code>. The resulting executable file will go either to the programs directory or to the <code>bin/_program-name_</code> directory. Check the documentation in the appropriate program directory. <br  />
</p>
<p class="startli">Example:</p>
</li>
</ul>
<div class="fragment"><div class="line">make examples/demo-elninio</div>
</div><!-- fragment --><pre class="fragment">```bash
make list
```

will print out the list of available programs. You can copy
</pre><p> the names of the targets from there.</p>
<ul>
<li><code>external/</code> You should build CAPD from this folder. The instructions are somwhere in this README.md file. <br  />
</li>
<li><code>scripts/</code> some usefull scripts in languages other than C++ (bash / Python / tex) to be used in some proofs to generate human-readable output (e.g. the formulation of existence theorems with nice estimates) This folder may not be present.</li>
<li><code>bin/</code> this directory is initially empty (or non-existent). If you will compile any program which accompany the library (programs folder), then it will be most probably placed here. Also compiled version of bundled CAPD will be placed here.</li>
<li><code>build-common.mk</code> <div class="fragment"><div class="line">{build-conf-bundle.mk```}</div>
<div class="line">   ```build-conf-svn.m</div>
</div><!-- fragment --></li>
</ul>
<pre class="fragment">those files serve to configure compilation 
(make, Makefile files in programs, etc.), see above
for the instruction on compilation. The ```-mp``` version is used
for multiprecision compilation (see for example converter programs), ```-svn``` version 
is for using your own (external) compilation of CAPD.
</pre><ul>
<li><p class="startli"><code>build-conf.mk</code></p>
<p class="startli">this file initially do not exists, but is required for compiltion; you should copy one of the <code>-bundle.mk</code> or <code>-svn.mk</code> files to this location as shown in previous sections.</p>
</li>
<li><code>README.md</code> this file</li>
</ul>
<p>The most important part is the rigorous integrator for DDEs. It is contained in <code>include/capd/ddes</code> As of 2022, I have decided to reorganize it to be more complaint with the CAPD structure. I have followed example of </p><div class="fragment"><div class="line"> {external/capd/capdDynSys4/include/capd/pdes```}</div>
<div class="line">folder structure in this manner. I hope capdDDEs can become a part of CAPD library </div>
<div class="line">at some point, when the library is mature enough.</div>
<div class="line"> </div>
<div class="line">THE CAPD LIBRARY</div>
<div class="line">----------------</div>
<div class="line"> </div>
<div class="line">In case of any errors in compiling CAPD library, please check requirements</div>
<div class="line">on http://capd.ii.uj.edu.pl, or contact me at robert.szczelina@uj.edu.pl.</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">### CAPD v. 6 AND SHARED LIBRARIES (UPDATED 2024)</div>
<div class="line"> </div>
<div class="line">The version from ```git``` repository seems to work out of the box,</div>
<div class="line">and probably the below comment is not neccessary anymore. </div>
<div class="line">Consider it deprecated, and remove it in future versions. </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">### CAPD v. 5 AND SHARED LIBRARIES (UPDATED 2022)</div>
<div class="line"> </div>
<div class="line">In a CAPD v5 there is a problem with compiled program, when the library</div>
<div class="line">was installed localy. The system does not see the dynamically linked </div>
<div class="line">libraries. </div>
<div class="line"> </div>
<div class="line">From &#39;make install&#39; of CAPD you get info similar to that:</div>
</div><!-- fragment --><blockquote class="doxtable">
<p>Libraries have been installed in: ~/workspace/capdDDEs5.1.2/bin/capd/lib</p>
<p>If you ever happen to want to link against installed libraries in a given directory, LIBDIR, you must either use libtool, and specify the full pathname of the library, or use the '-LLIBDIR' flag during linking and do at least one of the following:</p><ul>
<li>add LIBDIR to the 'LD_LIBRARY_PATH' environment variable during execution</li>
<li>add LIBDIR to the 'LD_RUN_PATH' environment variable during linking</li>
<li>use the '-Wl,-rpath -Wl,LIBDIR' linker flag</li>
<li>have your system administrator add LIBDIR to '/etc/ld.so.conf'</li>
</ul>
<p>See any operating system documentation about shared libraries for more information, such as the ld(1) and ld.so(8) manual pages. </p>
</blockquote>
<div class="fragment"><div class="line">For now, I do the following:</div>
<div class="line"> </div>
<div class="line"> - create file &#39;/etc/ld.so.conf.d/CAPDv5.conf&#39; with the LIBDIR in it:</div>
<div class="line"> </div>
<div class="line">    ```sudo cat &#39;/home/robson/workspace/capdDDEs5.1.2/bin/capd/lib&#39; &gt; /etc/ld.so.conf.d/CAPDv5.con</div>
</div><!-- fragment --><ul>
<li><p class="startli">reload ldconfig:</p>
<p class="startli"><code>sudo ldconfig</code></p>
</li>
</ul>
<p>The above solution requires admin rights. I think the following option:</p>
<ul>
<li><p class="startli">use the <code>'-Wl,-rpath -Wl,LIBDIR'</code> linker flag</p>
<p class="startli">could work better, it can be implemented with <code>Makefile</code>.</p>
<p class="startli"><em>TODO: Try to implement this method instead of ldconfig.</em></p>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
REFERENCES</h1>
<p>[^high-order-ddes]: Szczelina, R., Zgliczyński, P. "High-Order Lohner-Type Algorithm for Rigorous Computation of Poincaré Maps in Systems of Delay Differential Equations with Several Delays", Found Comput Math, Accepted, published online, (2023). <a href="https://doi.org/10.1007/s10208-023-09614-x">doi:s10208-023-09614-x</a>.</p>
<p>[^rignum-ddes]: Szczelina, R., Zgliczyński, P. "Algorithm for Rigorous Integration  of Delay Differential Equations and the Computer-Assisted Proof of Periodic Orbits in the Mackey–Glass Equation.", Found Comput Math 18, 1299–1332 (2018). <a href="https://doi.org/10.1007/s10208-017-9369-5">doi:10.1007/s10208-017-9369-5</a></p>
<p>[^logistic-dde]: Szczelina, R. "A computer assisted proof of multiple periodic orbits in some first order non-linear delay differential equation", Electronic Journal of Qualitative Theory of Differential Equations, No. 83, 1-19, (2016) <a href="https://doi.org/10.14232/ejqtde.2016.1.83">doi:10.14232/ejqtde.2016.1.83</a></p>
<p>[^phd-thesis]: Szczelina, R. "Rigorous Integration of Delay Differential Equations", PhD Thesis, (2015) </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
