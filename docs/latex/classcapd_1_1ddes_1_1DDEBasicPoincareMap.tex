\hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{}\doxysection{capd\+::ddes\+::D\+D\+E\+Basic\+Poincare\+Map$<$ Dyn\+Sys\+Spec, Section\+Spec $>$ Class Template Reference}
\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap}\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}


{\ttfamily \#include $<$D\+D\+E\+Basic\+Poincare\+Map.\+h$>$}

\doxysubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a9bf2774e2540aa7bf6914191a4ca837c}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a9bf2774e2540aa7bf6914191a4ca837c}} 
typedef \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$ {\bfseries Class}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ac9d6b816dfc0ffd4bab6ffd1992d066f}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ac9d6b816dfc0ffd4bab6ffd1992d066f}} 
typedef Dyn\+Sys\+Spec {\bfseries Dyn\+Sys\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2367151cc36f0a1ed10ffa9c415f2a40}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2367151cc36f0a1ed10ffa9c415f2a40}} 
typedef Section\+Spec {\bfseries Section\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a3c2cd2ff853340381a750143799822d4}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a3c2cd2ff853340381a750143799822d4}} 
typedef Dyn\+Sys\+Spec\+::\+Curve\+Type {\bfseries Curve\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a120a99e419f060c121057f1461478a30}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a120a99e419f060c121057f1461478a30}} 
typedef Curve\+Type\+::\+Time\+Point\+Type {\bfseries Time\+Point\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ac7fe84f23726919a2f7cc96e37b6ad45}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ac7fe84f23726919a2f7cc96e37b6ad45}} 
typedef Curve\+Type\+::\+Vector\+Type {\bfseries Vector\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a1691ec1f094017e77e855a82b1e4d23d}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a1691ec1f094017e77e855a82b1e4d23d}} 
typedef Curve\+Type\+::\+Matrix\+Type {\bfseries Matrix\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a397b26c8d8b6e9a7841bc01900c66790}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a397b26c8d8b6e9a7841bc01900c66790}} 
typedef Curve\+Type\+::\+Scalar\+Type {\bfseries Scalar\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_af9d5a46c2cf6c2aafc64a1155877a8fe}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_af9d5a46c2cf6c2aafc64a1155877a8fe}} 
typedef Curve\+Type\+::\+Real\+Type {\bfseries Real\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a0ff3a1eb54b8b6b5ee5acc9519d07e66}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a0ff3a1eb54b8b6b5ee5acc9519d07e66}} 
typedef Dyn\+Sys\+Type\+::\+Jacobian\+Storage\+Type {\bfseries Jacobian\+Storage\+Type}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aee25aef63055643ea5cd6e243256a626}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aee25aef63055643ea5cd6e243256a626}} 
typedef Curve\+Type\+::size\+\_\+type {\bfseries size\+\_\+type}
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a8ccd6bf8ea44806e7c1b865785d8efbf}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a8ccd6bf8ea44806e7c1b865785d8efbf}} 
{\bfseries D\+D\+E\+Basic\+Poincare\+Map} (\mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{D\+D\+E\+Basic\+Poincare\+Map}} const \&other)
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a850ed85aeae39842e86969837f1f3177}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a850ed85aeae39842e86969837f1f3177}} 
{\bfseries D\+D\+E\+Basic\+Poincare\+Map} (Dyn\+Sys\+Type \&dynsys, Section\+Type \&section, Crossing\+Direction direction=Crossing\+Direction\+::\+Both, int req\+Steps=0, int max\+Steps=-\/1, double binsearch\+Epsilon=D\+E\+F\+A\+U\+L\+T\+\_\+\+B\+I\+N\+S\+E\+A\+R\+C\+H\+\_\+\+E\+P\+S\+I\+L\+ON)
\item 
Curve\+Type \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aea57b2b9505711ea5b59a77d12cd7a63}{operator()}} (Curve\+Type const \&X)
\item 
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aaeec9b7a9bf93e497b38ee9a6e20fc17}{operator()}} (Curve\+Type \&curve, Curve\+Type \&on\+\_\+section, Real\+Type \&out\+\_\+approach\+Time)
\item 
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2d3814773af94e5cb310f8971526a776}{operator()}} (Curve\+Type \&in\+\_\+out\+\_\+curve, Curve\+Type \&in\+\_\+out\+\_\+\+Pcurve, Real\+Type \&out\+\_\+approach\+Time, Vector\+Type \&out\+\_\+x, Vector\+Type \&out\+\_\+\+Px, Vector\+Type \&out\+\_\+f\+Px, Matrix\+Type \&out\+\_\+V, Matrix\+Type \&out\+\_\+\+DP)
\item 
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a9cfc0b41360017d417053f8c32719371}{set\+InitialV}} (Curve\+Type \&in\+\_\+out\+\_\+curve)
\item 
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a85df8673f19d569952a87bc7042f76c5}{set\+InitialV}} (Curve\+Type \&in\+\_\+out\+\_\+curve, Matrix\+Type const \&V)
\item 
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a5975c76ac0bfacae3e26a8fd63ce2eed}{set\+CurrentV}} (Curve\+Type \&in\+\_\+out\+\_\+curve, Matrix\+Type const \&V)
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a07e41bb641b00c46dc391f4288068dc3}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a07e41bb641b00c46dc391f4288068dc3}} 
\mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{D\+D\+E\+Basic\+Poincare\+Map}} \& {\bfseries set\+Direction} (Crossing\+Direction direction)
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a76dc765d07fa6baf7339025104f7fe12}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a76dc765d07fa6baf7339025104f7fe12}} 
Crossing\+Direction {\bfseries get\+Direction} ()
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a5c07f8d12ec3d777c78f36121a5ed280}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a5c07f8d12ec3d777c78f36121a5ed280}} 
\mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{D\+D\+E\+Basic\+Poincare\+Map}} \& {\bfseries set\+Max\+Steps} (int max\+Steps)
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a076854ede8009f0dd5643655c0ccd213}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a076854ede8009f0dd5643655c0ccd213}} 
int {\bfseries get\+Max\+Steps} ()
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ad5f4fc75f6dbaa8719b67773f7fb55b3}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ad5f4fc75f6dbaa8719b67773f7fb55b3}} 
int {\bfseries get\+Maximum\+Steps} ()
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2676564685daa06e986aed873a2654c8}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2676564685daa06e986aed873a2654c8}} 
\mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{D\+D\+E\+Basic\+Poincare\+Map}} \& {\bfseries set\+Required\+Steps} (int required\+Steps)
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a9db15b4d7aace0d8e3fabd995bbb9365}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a9db15b4d7aace0d8e3fabd995bbb9365}} 
int {\bfseries get\+Required\+Steps} ()
\item 
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a0a51afde5264002e255705579bb48d81}{integrate\+Until\+Section\+Crossing}} (Curve\+Type \&curve, Real\+Type \&time\+Before\+Section, Single\+Step\+Fn step\+Fn)
\item 
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a253430a39173974c1e87dab5ae626672}{find\+Crossing\+Time}} (Curve\+Type const \&curve, Curve\+Type \&requested, Real\+Type \&crossing\+Time, int test\+Direction)
\item 
Crossing\+Direction \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a730e9cc74bbcf9f3cd7aee77e69c822c}{detect\+Crossing\+Direction}} (Curve\+Type const \&curve)
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a3ee64050e3bafa5c11a72ca3acb05342}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a3ee64050e3bafa5c11a72ca3acb05342}} 
Real\+Type {\bfseries get\+Last\+Epsilon\+Time} () const
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ac95572dc323729f807701a0d3f31f579}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ac95572dc323729f807701a0d3f31f579}} 
Real\+Type {\bfseries get\+Last\+Time\+Before\+Section} () const
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_acb800b2452f58750f630218aef0bef9c}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_acb800b2452f58750f630218aef0bef9c}} 
Real\+Type {\bfseries get\+Last\+Reach\+Time} () const
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a361857c7413d83910d41003801692454}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a361857c7413d83910d41003801692454}} 
Jacobian\+Storage\+Type {\bfseries get\+Last\+Variational} () const
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a8ef520b30779a1d3513ebba663d94739}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a8ef520b30779a1d3513ebba663d94739}} 
int {\bfseries get\+Last\+Steps\+After\+Section} ()
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a6e0e8ae40ffe8b134b204ca7c2506465}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a6e0e8ae40ffe8b134b204ca7c2506465}} 
bool {\bfseries is\+Normalize\+Variational} () const
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_adcd4ba8face8a0ead9ac0cee1fd5a368}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_adcd4ba8face8a0ead9ac0cee1fd5a368}} 
\mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{Class}} \& {\bfseries set\+Normalize\+Variational} (bool value)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_adf4ede9305db42ef318c5dd181283bc6}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_adf4ede9305db42ef318c5dd181283bc6}} 
void {\bfseries check\+Steps} ()
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a96df8b62912d997a10cca7db26c00b2c}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a96df8b62912d997a10cca7db26c00b2c}} 
void {\bfseries extract\+Variational\+Matrix} (Curve\+Type const \&curve, Matrix\+Type \&fullV, Matrix\+Type \&reducedV, std\+::vector$<$ size\+\_\+type $>$ reduced\+Shape, int p\+\_\+how\+Far=-\/1) const
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a0d38dfed36d2727964f5b2f99885e478}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a0d38dfed36d2727964f5b2f99885e478}} 
void {\bfseries extract\+Variational\+Matrix} (Curve\+Type const \&curve, Matrix\+Type \&fullV) const
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a62e2f5b504b76fad0688098a6a4c24d7}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a62e2f5b504b76fad0688098a6a4c24d7}} 
Dyn\+Sys\+Type \& {\bfseries m\+\_\+dynsys}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a7b1f69ece04ac628f60cc7153524036c}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a7b1f69ece04ac628f60cc7153524036c}} 
Section\+Type \& {\bfseries m\+\_\+section}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a6f251aba1639744a06d14caa8636adb1}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a6f251aba1639744a06d14caa8636adb1}} 
Crossing\+Direction {\bfseries m\+\_\+direction}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2225f9bfcf5018813f2e695ac6188253}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2225f9bfcf5018813f2e695ac6188253}} 
int {\bfseries m\+\_\+required\+Steps}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_af060e5b37b27d0dd7ccbe40fd8e1741a}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_af060e5b37b27d0dd7ccbe40fd8e1741a}} 
int {\bfseries m\+\_\+max\+Steps}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ab726efd68d0e64894d3e3b3d2699c242}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_ab726efd68d0e64894d3e3b3d2699c242}} 
int {\bfseries m\+\_\+steps}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aa073ac7dc88b0f373b35c7f7b2c044c6}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aa073ac7dc88b0f373b35c7f7b2c044c6}} 
double {\bfseries m\+\_\+binsearch\+Epsilon}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a8f60cff312113b49e780f3a044ce9a70}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a8f60cff312113b49e780f3a044ce9a70}} 
Real\+Type {\bfseries m\+\_\+last\+Time\+Before\+Section}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_abdfcb58554e04c957171728ed46b4177}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_abdfcb58554e04c957171728ed46b4177}} 
Real\+Type {\bfseries m\+\_\+last\+Epsilon\+Time}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_af192bc5f72418f6ff1d9235c43f735dc}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_af192bc5f72418f6ff1d9235c43f735dc}} 
Jacobian\+Storage\+Type {\bfseries m\+\_\+variational}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aca08faa5b417e6a69eb3a1ffeae778cd}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aca08faa5b417e6a69eb3a1ffeae778cd}} 
bool {\bfseries m\+\_\+normalize\+Variational}
\item 
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aab24e3999af681048507194f007acc20}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aab24e3999af681048507194f007acc20}} 
std\+::vector$<$ size\+\_\+type $>$ {\bfseries m\+\_\+stored\+Initial\+Shape}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename Dyn\+Sys\+Spec, typename Section\+Spec$>$\newline
class capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map$<$ Dyn\+Sys\+Spec, Section\+Spec $>$}

Implementation of Poincare Map for use with nonrigorous D\+D\+E\+Solvers.

In theory should work with any compatible D\+D\+E\+Dyn\+Sys and Section.

T\+O\+DO\+: (N\+OT U\+R\+G\+E\+NT)\+: check the interface is compatible with C\+A\+PD Poincare Map T\+O\+DO\+: (N\+OT U\+R\+G\+E\+NT)\+: Especially operators and integrate\+Until\+Section\+Crossing, if they need extra n (numnber of iterates) parameter T\+O\+DO\+: (F\+U\+T\+U\+RE, N\+OT U\+R\+G\+E\+NT, R\+E\+T\+H\+I\+NK)\+: should I rewrite the library so that normal Poncare\+Map from C\+A\+PD can be used with my system? It may not be feasible, as C\+A\+PD assumes not (semi) in dynamical system. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a730e9cc74bbcf9f3cd7aee77e69c822c}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a730e9cc74bbcf9f3cd7aee77e69c822c}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!detectCrossingDirection@{detectCrossingDirection}}
\index{detectCrossingDirection@{detectCrossingDirection}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{detectCrossingDirection()}{detectCrossingDirection()}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
Crossing\+Direction \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::detect\+Crossing\+Direction (\begin{DoxyParamCaption}\item[{Curve\+Type const \&}]{curve }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

warning\+: might be time consuming, it (might) integrate the solution... it assumes curve is on section. \mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a253430a39173974c1e87dab5ae626672}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a253430a39173974c1e87dab5ae626672}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!findCrossingTime@{findCrossingTime}}
\index{findCrossingTime@{findCrossingTime}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{findCrossingTime()}{findCrossingTime()}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::find\+Crossing\+Time (\begin{DoxyParamCaption}\item[{Curve\+Type const \&}]{curve,  }\item[{Curve\+Type \&}]{requested,  }\item[{Real\+Type \&}]{crossing\+Time,  }\item[{int}]{test\+Direction }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

test\+Direction = -\/1 for before section test\+Direction = +1 for after section binsearch for now\mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a0a51afde5264002e255705579bb48d81}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a0a51afde5264002e255705579bb48d81}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!integrateUntilSectionCrossing@{integrateUntilSectionCrossing}}
\index{integrateUntilSectionCrossing@{integrateUntilSectionCrossing}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{integrateUntilSectionCrossing()}{integrateUntilSectionCrossing()}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::integrate\+Until\+Section\+Crossing (\begin{DoxyParamCaption}\item[{Curve\+Type \&}]{curve,  }\item[{Real\+Type \&}]{time\+Before\+Section,  }\item[{Single\+Step\+Fn}]{step\+Fn }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

it extends the solution until the crossing with the section. Also, it takes into consideration the required number of steps (should be set-\/up before) It also moves away of section is initially curve crosses the section.

W\+A\+R\+N\+I\+NG\+: it does not check for sanity of argument as of now, so it might cause runtime-\/errors if the proof is not well prepared. \mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aaeec9b7a9bf93e497b38ee9a6e20fc17}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aaeec9b7a9bf93e497b38ee9a6e20fc17}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!operator()@{operator()}}
\index{operator()@{operator()}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{operator()()}{operator()()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::operator() (\begin{DoxyParamCaption}\item[{Curve\+Type \&}]{curve,  }\item[{Curve\+Type \&}]{on\+\_\+section,  }\item[{Real\+Type \&}]{out\+\_\+approach\+Time }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

First parameter will change! There will be a curve that reaches first full step after the section, define dover the whole integration time. So if you want to save it, use a copy in curve parameter.

In on\+\_\+section there will be the image on the section, as close to section as possible.

The parameter on\+\_\+section must be initialized with the desired \char`\"{}length\char`\"{} (time interval) and \char`\"{}order\char`\"{} of the representation. It also must be compatible (length, order) with the section.

Both parameters should be defined on the same Grid.

In out\+\_\+approach\+Time you will get the return time to section. \mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2d3814773af94e5cb310f8971526a776}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a2d3814773af94e5cb310f8971526a776}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!operator()@{operator()}}
\index{operator()@{operator()}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{operator()()}{operator()()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::operator() (\begin{DoxyParamCaption}\item[{Curve\+Type \&}]{in\+\_\+out\+\_\+curve,  }\item[{Curve\+Type \&}]{in\+\_\+out\+\_\+\+Pcurve,  }\item[{Real\+Type \&}]{out\+\_\+approach\+Time,  }\item[{Vector\+Type \&}]{out\+\_\+x,  }\item[{Vector\+Type \&}]{out\+\_\+\+Px,  }\item[{Vector\+Type \&}]{out\+\_\+f\+Px,  }\item[{Matrix\+Type \&}]{out\+\_\+V,  }\item[{Matrix\+Type \&}]{out\+\_\+\+DP }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

For other parameters and base description, see the other operator()

This is more complicated than the case of O\+D\+Es, but for technical reasons it is most desirable to work with vector/matrix representations of the objects when dealing with variational equation on the coefficients.

N\+O\+TE\+: Curve\+Type must be defined with Data\+Type that allows to handle extra Matrix data. I have special structures for this. C\+Heck examples and helper classes. Thanks to C++ lazy evaluation of templates this also works on the basic data structure as long as you do not call the function in the program.

out\+\_\+x is vector representation of input curve out\+\_\+\+Px is vector representation of the image on the section (Pcurve) out\+\_\+f\+Px is the value of the \char`\"{}\+Vector Field\char`\"{} of the equation as defined in the Banach space in practice, if c = Px is a curve in C(\mbox{[}-\/tau, 0\mbox{]}, \textbackslash{}R$^\wedge$d), then out\+\_\+f\+Px = c\textquotesingle{}. This is theoretically correct when c is on the C$^\wedge$1 solutions manifold, i.\+e. c(0$^\wedge$-\/) == f(c) where f is the r.\+h.\+s. of the D\+DE. This is true for any initial curve, if the reach\+Time $>$ delay. See works for more explanation. out\+\_\+V is the variational equation solution on the coefficients, i.\+e. d\textbackslash{}varphi(t\+\_\+p, x)/dx (in sense of the coefficients defining x) therefore it is of dimension out\+\_\+x.\+dimension() x out\+\_\+x.\+dimension() out\+\_\+\+DP is the d\+P/dx (x) (derivative of P w.\+r.\+t. initial data, computed at point x) out\+\_\+\+DP is obtained from out\+\_\+V by some correction on the reach time t\+\_\+p(x) in the neighbourhood of x. i.\+e. d\+P/dx (x) = d(\textbackslash{}varphi(t\+\_\+p(x), x))/dx = = \textbackslash{}partial(\textbackslash{}varphi)/\textbackslash{}partial x (t\+\_\+p(x), x) +
\begin{DoxyItemize}
\item \textbackslash{}partial(\textbackslash{}varphi)/\textbackslash{}partial t (t\+\_\+p(x), x) $\ast$ d(t\+\_\+p)/dx (x) = V + f(\+Px) $\ast$ dt\+\_\+p/dx (x) Please note that f(\+Px) is \char`\"{}vertical\char`\"{} and dt\+\_\+p/dx (x) is \char`\"{}horizontal\char`\"{} vector so their product is a full matrix of desired dimension! We see that f(\+Px) is in out\+\_\+f\+Px, V in out\+\_\+V, then the last term is obtained by differentiation of the section condition equation\+:
\end{DoxyItemize}

s(\textbackslash{}varphi(t\+\_\+p(x), x)) == 0

so we get ($\ast$ means scalar product in \textbackslash{}R$^\wedge$M where needed, M = out\+\_\+x.\+dimension())

\textbackslash{}gradient s $\ast$ (V + f(\+Px) $\ast$ dt\+\_\+p/dx (x)) == 0 so dt\+\_\+p/dx (x) = -\/ (\{\textbackslash{}gradient s\} $\ast$ V) / (\{\textbackslash{}gradient s\} $\ast$ f(\+Px))

Note, that (\{\textbackslash{}gradient s\} $\ast$ f(\+Px)) is simply a scalar, and it needs to be not equal 0 for the formula to make sense. This is usual notion of the section to be transversal to the flow at x.

Finally, note that x, Px, f\+Px can be used in .set\+\_\+x() to a curve of a proper structure (important!) to get interesting data. The proper structure is stored in Pcurve, i.\+e. usually, one can do\+: curve\+\_\+x = Pcurve; curve\+\_\+x.\+set\+\_\+x(out\+\_\+x); // guaranteed\+: curve\+\_\+x == curve.\+subcurve(\mbox{[}-\/tau, 0\mbox{]}) curve\+\_\+\+Px = Pcurve; curve\+\_\+\+Px.\+set\+\_\+x(out\+\_\+\+Px); // guaranteed\+: curve\+\_\+\+Px == Pcurve curve\+\_\+f\+Px = Pcurve; curve\+\_\+f\+Px.\+set\+\_\+x(out\+\_\+f\+Px); // guaranteed\+: curve\+\_\+f\+Px == (Pcurve)\textquotesingle{}

I\+M\+P\+O\+R\+T\+A\+NT\+: curve\+\_\+f\+Px will be of one order higher than simply trying to compute Pcurve.\+dt()! I\+M\+P\+O\+R\+T\+A\+NT\+: as .dt() loses one order. So Pcurve.\+dt() is not a proper way to get \char`\"{}force field\char`\"{} I\+M\+P\+O\+R\+T\+A\+NT\+: on curve\+\_\+\+Px, as the dimensions will be different (orders different). I\+M\+P\+O\+R\+T\+A\+NT\+: Therefore, use curve\+\_\+f\+Px to get the value of the \char`\"{}force field\char`\"{} on curve\+\_\+\+Px. \mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aea57b2b9505711ea5b59a77d12cd7a63}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_aea57b2b9505711ea5b59a77d12cd7a63}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!operator()@{operator()}}
\index{operator()@{operator()}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{operator()()}{operator()()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
Curve\+Type \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::operator() (\begin{DoxyParamCaption}\item[{Curve\+Type const \&}]{X }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

This is probably the simplest version to be used by the end user.

It is simply applied like\+: \begin{DoxyVerb}    CurveType X(...); // init to what you want
    auto PX = P(X);   // PX will be the same shape as X
    // so you can e.g. compute difference between representations
    capd::vectalg::EuclNorm<VectorType, MatrixType> euclNorm;
    auto diff = euclNorm((VectorType)PX - (VectorType)X)
\end{DoxyVerb}


to be compatible with standard notion and C\+A\+PD interface, It makes following assumptions\+:
\begin{DoxyItemize}
\item X and PX will have the same structure (i.\+e. over same grid points and jets of the same order).
\end{DoxyItemize}

N\+O\+TE\+: you can retrieve information on reach time and epsilon step (see get\+Last$\ast$$\ast$$\ast$() functions), but you cannot acquire the solution on the whole time. If you need solution over the full integration time, then use other operator(). \mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a5975c76ac0bfacae3e26a8fd63ce2eed}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a5975c76ac0bfacae3e26a8fd63ce2eed}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!setCurrentV@{setCurrentV}}
\index{setCurrentV@{setCurrentV}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{setCurrentV()}{setCurrentV()}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::set\+CurrentV (\begin{DoxyParamCaption}\item[{Curve\+Type \&}]{in\+\_\+out\+\_\+curve,  }\item[{Matrix\+Type const \&}]{V }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Experimental... \mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a9cfc0b41360017d417053f8c32719371}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a9cfc0b41360017d417053f8c32719371}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!setInitialV@{setInitialV}}
\index{setInitialV@{setInitialV}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{setInitialV()}{setInitialV()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::set\+InitialV (\begin{DoxyParamCaption}\item[{Curve\+Type \&}]{in\+\_\+out\+\_\+curve }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

helper function, sets to Id the Variational matrix w.\+r.\+t. initial coefficients in curve T\+O\+DO\+: D\+RY \mbox{\Hypertarget{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a85df8673f19d569952a87bc7042f76c5}\label{classcapd_1_1ddes_1_1DDEBasicPoincareMap_a85df8673f19d569952a87bc7042f76c5}} 
\index{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}!setInitialV@{setInitialV}}
\index{setInitialV@{setInitialV}!capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$@{capd::ddes::DDEBasicPoincareMap$<$ DynSysSpec, SectionSpec $>$}}
\doxysubsubsection{\texorpdfstring{setInitialV()}{setInitialV()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily template$<$typename Dyn\+Sys\+Spec , typename Section\+Spec $>$ \\
void \mbox{\hyperlink{classcapd_1_1ddes_1_1DDEBasicPoincareMap}{capd\+::ddes\+::\+D\+D\+E\+Basic\+Poincare\+Map}}$<$ Dyn\+Sys\+Spec, Section\+Spec $>$\+::set\+InitialV (\begin{DoxyParamCaption}\item[{Curve\+Type \&}]{in\+\_\+out\+\_\+curve,  }\item[{Matrix\+Type const \&}]{V }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

sets initial V to a given Matrix. Matrix must be of a good shape T\+O\+DO\+: D\+RY 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/robson/\+R\+O\+B\+E\+R\+T-\/\+P\+R\+A\+C\+A-\/\+C\+H\+M\+U\+R\+A/eclipse-\/workspace/capd\+D\+D\+Es5.\+1.\+2/include/capd/ddes/D\+D\+E\+Basic\+Poincare\+Map.\+h\end{DoxyCompactItemize}
